$NetBSD$

--- dbus/dbus-sysdeps-util-unix.c.orig	2009-05-06 13:26:48.000000000 -0400
+++ dbus/dbus-sysdeps-util-unix.c
@@ -53,6 +53,9 @@
 #ifdef HAVE_SYS_SYSLIMITS_H
 #include <sys/syslimits.h>
 #endif
+#ifdef __QNXNTO__
+#include <limits.h>
+#endif
 
 #ifndef O_BINARY
 #define O_BINARY 0
@@ -709,7 +712,9 @@ static dbus_bool_t
 dirent_buf_size(DIR * dirp, size_t *size)
 {
  long name_max;
-#   if defined(HAVE_FPATHCONF) && defined(_PC_NAME_MAX)
+#   if defined(__QNXNTO__)
+          name_max = PATH_MAX;
+#   elif defined(HAVE_FPATHCONF) && defined(_PC_NAME_MAX)
 #      if defined(HAVE_DIRFD)
           name_max = fpathconf(dirfd(dirp), _PC_NAME_MAX);
 #      elif defined(HAVE_DDFD)
@@ -1233,4 +1238,4 @@ fail:
   _dbus_string_free (&cmdline);
   _dbus_string_free (&path);
   return FALSE;
-}
\ No newline at end of file
+}
