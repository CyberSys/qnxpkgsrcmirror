$NetBSD$

--- src/command.C.orig	2008-11-05 16:21:05.000000000 +0000
+++ src/command.C
@@ -61,6 +61,9 @@
 #if LINUX_YIELD_HACK
 # include <ctime>
 #endif
+#ifdef __QNXNTO__
+#include <wctype.h>
+#endif
 
 /*----------------------------------------------------------------------*/
 
@@ -199,7 +202,18 @@ rxvt_term::iso14755_51 (unicode_t ch, re
            r & RS_Uline   ? " uline"   : "",
            r & RS_Careful ? " careful" : "");
 
+#ifndef __QNXNTO__
   int width = wcswidth (fname, wcslen (fname));
+#else
+  int width, i, lim;
+  width = 0;
+  lim = wcslen(fname);
+  for (i = 0, width = 0; i < lim; i++) {
+	if (iswprint(fname[i]))
+		len++;
+
+  }
+#endif
 
   max_it (width, 8+5); // for char + hex
   max_it (width, strlen (attr));
@@ -3336,7 +3350,7 @@ rxvt_term::process_xterm_seq (int op, co
           }
         else
           {
-            char *eq = strchr (str, '='); // constness lost, but verified to be ok
+            char *eq = (char *)strchr (str, '='); // constness lost, but verified to be ok
 
             if (eq)
               {
